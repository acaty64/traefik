#docker-compose.yml
#https://codigofacilito.com/videos/introduccion-96456894-edd1-43ed-932a-3ccc2d370c3f
# TRAEFIK

version: '3'

# Services
services:
    proxy:
        image: traefik:v2.1
        container_name: proxy
        ports:
            - "80:80"
            - "8080:8080"

        volumes:
            - /var/run/docker.sock:/var/run/docker.sock
            - ./traefik.yml:/traefik.yml
            - ./traefik.log:/traefik.log

    nginx:
        image: nginx
        container_name: nginx
        labels:
            - "environment=dev"
            - "traefik.http.routers.nginx.rule=Host(`nginx.app.test`)"

    app:
        image: app
        container_name: app
        labels:
            - "environment=production"
            - "traefik.enable=true"
            - "traefik.http.routers.app.rule=Host(`apache.app.test`)"

